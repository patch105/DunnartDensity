<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Charlotte Patterson &amp; Alice Bakker">

<title>Julia Creek Dunnart Density Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Dunnart_Density_files/libs/clipboard/clipboard.min.js"></script>
<script src="Dunnart_Density_files/libs/quarto-html/quarto.js"></script>
<script src="Dunnart_Density_files/libs/quarto-html/popper.min.js"></script>
<script src="Dunnart_Density_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Dunnart_Density_files/libs/quarto-html/anchor.min.js"></script>
<link href="Dunnart_Density_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Dunnart_Density_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Dunnart_Density_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Dunnart_Density_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Dunnart_Density_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Julia Creek Dunnart Density Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Charlotte Patterson &amp; Alice Bakker </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="project-description" class="level2">
<h2 class="anchored" data-anchor-id="project-description">Project Description</h2>
<p>The Julia Creek Dunnart (<em>Sminthopsis douglasi</em>) is an endangered small mammal found in central west Queensland, Australia. This project aims to provide the first population density and population size estimates for <em>S. douglasi</em> within a national park. Density and population size are estimated via spatially explicit capture-recapture, using live capture data collected over seven trapping sessions between 2022 and 2023.</p>
<p>Further details of the project methods, results, and discussion are presented in our paper entitled: “Density of a cryptic Australian small mammal: the threatened Julia Creek Dunnart (<em>Sminthopsis douglasi</em>)” Ecology and Evolution. A. H. Bakker, Patterson C.R., Mifsud G., Reside A., Fuller S., and Baker A.M.</p>
</section>
<section id="load-required-packages" class="level1">
<h1>Load required packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"secr"</span>, <span class="st">"here"</span>, <span class="st">"sf"</span>, <span class="st">"ggplot2"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(packages, require, <span class="at">character.only =</span> T)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-the-data" class="level1">
<h1>Load the data</h1>
<p>Load the capture file and the trap file. View these. Each session is a unique trapping period at one of the two sites (Scrammy, Campbells). Each row is a unique capture event. The ID for individual animals is in the column “ID”. The column “occasion” is the trap night for that session. The Detector is the unique ID for each trap.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>CH_zero <span class="ot">&lt;-</span> <span class="fu">read.capthist</span>(<span class="st">"Data/captfile_zeros.txt"</span>, <span class="st">"Data/trapfile.txt"</span>, <span class="at">detector =</span> <span class="st">"multi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Session campbellsfive 
No live releases
Session campbellsfour 
No live releases
Session campbellsthree 
No live releases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>CH <span class="ot">&lt;-</span> <span class="fu">read.capthist</span>(<span class="st">"Data/captfile.txt"</span>, <span class="st">"Data/trapfile.txt"</span>, <span class="at">detector =</span> <span class="st">"multi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No errors found :-)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set order to make sure session-specific trap layouts match with sessions order at the two field sites (ordered by session name)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>CH_zero <span class="ot">&lt;-</span> <span class="fu">read.capthist</span>(<span class="st">"Data/captfile_zeros.txt"</span>, <span class="fu">c</span>(<span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>), </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">detector =</span> <span class="st">"multi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Session campbellsfive 
No live releases
Session campbellsfour 
No live releases
Session campbellsthree 
No live releases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>CH_zero <span class="ot">&lt;-</span> <span class="fu">read.capthist</span>(<span class="st">"Data/captfile.txt"</span>, <span class="fu">c</span>(<span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_campbells_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>, <span class="st">"Data/trapfile_scrammy_MGA2020.txt"</span>), </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">detector =</span> <span class="st">"multi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No errors found :-)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CH, <span class="at">terse =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           campbellsseven campbellssix campbellstwo scrammyfive scrammyfour
Occasions               7            7            6           7           4
Detections              9           15            3           4           2
Animals                 6            9            3           4           1
Detectors             200          200          200         200         200
           scrammyseven scrammysix scrammythree scrammytwo
Occasions             7          7            7          2
Detections            8         28           12          2
Animals               5         19            9          2
Detectors           200        200          200        200</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or view full summary output</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(CH)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-recaptures" class="level1">
<h1>Plot recaptures</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CH_zero, <span class="at">tracks =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.capthist(CH_zero, tracks = TRUE): screen layout does not allow
for all sessions and some plots may be lost; set par mfrow</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-4-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>campbellsseven   campbellssix   campbellstwo    scrammyfive    scrammyfour 
             9             15              3              4              2 
  scrammyseven     scrammysix   scrammythree     scrammytwo 
             8             28             12              2 </code></pre>
</div>
</div>
<p>View successive trap-revealed movement distances, summarise with the median and a histogram. Observing that most individuals were showing movements &gt; 50 m (our trap spacing) suggests that even individuals with home range centres outside of the trapping grid would have had the opportunity to be caught (Efford, 2022).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">moves</span>(CH_zero)) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>campbellsseven.21 campbellsseven.22  campbellsseven.4   campbellssix.11 
        261.83551          49.15844         203.51493          51.38980 
  campbellssix.12    campbellssix.2    campbellssix.3    campbellssix.6 
         67.85502          50.67253          49.98391          66.75001 
   campbellssix.7     scrammyfour.1   scrammyseven.21   scrammyseven.22 
         49.96525          61.19083         178.07939         168.17787 
  scrammyseven.23     scrammysix.31     scrammysix.32      scrammysix.5 
        156.93552           0.00000           0.00000          98.40969 
     scrammysix.6      scrammysix.7     scrammysix.81     scrammysix.82 
        320.85100         106.18599         101.69885          68.56398 
   scrammysix.111    scrammysix.112   scrammythree.21   scrammythree.22 
         47.38029          47.38029          51.40011          51.40011 
   scrammythree.4 
         61.06169 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61.19083</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="co"># reduce margins</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(m, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">550</span>,<span class="dv">30</span>), <span class="at">xlab =</span> <span class="st">"Movement (m)"</span>, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="choosing-detection-function" class="level2">
<h2 class="anchored" data-anchor-id="choosing-detection-function">Choosing detection function</h2>
<p>We must check the effect of different detection function shapes. We do this by fitting models with the half-normal and exponential functions and comparing the estimated densities. We set the autoini = 6 to set our starting parameter values from a session with capture data. The default for a multi-session analysis is to take starting parameter values from the first session which doesn’t work when the session has no captures.</p>
<p>We also compare model fit via AICc (Akaike’s Information Criterion).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The half-normal</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fit.HN <span class="ot">&lt;-</span> <span class="fu">secr.fit</span>(CH_zero,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">detectfn =</span> <span class="st">'HN'</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">buffer =</span> <span class="dv">300</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">details =</span> <span class="fu">list</span>(<span class="at">autoini =</span> <span class="dv">6</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">trace =</span> F)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Now the exponential</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fit.EX <span class="ot">&lt;-</span> <span class="fu">secr.fit</span> (CH_zero,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">detectfn =</span> <span class="st">'EX'</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">buffer =</span> <span class="dv">300</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">details =</span> <span class="fu">list</span>(<span class="at">autoini =</span> <span class="dv">6</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trace =</span> <span class="cn">FALSE</span>,)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Combine into an object of class secrlist</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">secrlist</span>(<span class="at">HN =</span> fit.HN, <span class="at">EX =</span> fit.EX)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the density values, g0 and sigma, plus SEs</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$HN
$HN$`session = campbellsseven`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = campbellssix`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = campbellstwo`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = scrammyfive`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = scrammyfour`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = scrammyseven`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = scrammysix`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = scrammythree`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721

$HN$`session = scrammytwo`
       link    estimate SE.estimate          lcl         ucl
D       log  0.33202500 0.064300035  0.227951195  0.48361494
g0    logit  0.01618156 0.004387746  0.009492003  0.02745496
sigma   log 68.01014395 8.308833941 53.575581980 86.33372721


$EX
$EX$`session = campbellsseven`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = campbellssix`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = campbellstwo`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = scrammyfive`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = scrammyfour`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = scrammyseven`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = scrammysix`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = scrammythree`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268

$EX$`session = scrammytwo`
       link    estimate SE.estimate         lcl         ucl
D       log  0.34777427  0.06755423  0.23849671  0.50712205
g0    logit  0.05377493  0.01705575  0.02861917  0.09879332
sigma   log 36.44931760  5.64299936 26.95801436 49.28229268</code></pre>
</div>
</div>
<p>The density estimates are similar. The difference is in the detection parameters g0 and sigma.</p>
<p>Apply AICc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fits,<span class="at">criterion =</span> <span class="st">'AICc'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              model    detectfn npar    logLik     AIC    AICc dAICc AICcwt
EX D~1 g0~1 sigma~1 exponential    3 -478.8920 963.784 964.228 0.000 0.9853
HN D~1 g0~1 sigma~1  halfnormal    3 -483.0948 972.190 972.634 8.406 0.0147</code></pre>
</div>
</div>
<p>The most-supported model is the exponential, with an AICc weight of 0.99 and a ΔAICc from the exponential to the half-normal of 8.4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">esa.plot</span>(fits)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">300</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="choosing-buffer-width-option-without-mask" class="level2">
<h2 class="anchored" data-anchor-id="choosing-buffer-width-option-without-mask">Choosing Buffer Width (option without mask)</h2>
<p>Now we print an initial estimate of sigma (a measure of home range shape - how much the probability of capture declines with distance from a trap). We x this by 4 to get a quick estimate of potential buffer widths. This differs across sessions a bit so we might choose to think about using the maximum (~300).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>initialsigma <span class="ot">&lt;-</span> <span class="fu">RPSV</span>(CH_zero, <span class="at">CC =</span> <span class="cn">TRUE</span>) </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(initialsigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$campbellsseven
[1] 108.4343

$campbellssix
[1] 27.85704

$campbellstwo
[1] NaN

$scrammyfive
[1] NaN

$scrammyfour
[1] 30.59558

$scrammyseven
[1] 72.99183

$scrammysix
[1] 62.23358

$scrammythree
[1] 24.58182

$scrammytwo
[1] NaN</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(initialsigma, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">print</span>(x<span class="sc">*</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 433.7371
[1] 111.4282
[1] NaN
[1] NaN
[1] 122.3823
[1] 291.9673
[1] 248.9343
[1] 98.32728
[1] NaN</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$campbellsseven
[1] 433.7371

$campbellssix
[1] 111.4282

$campbellstwo
[1] NaN

$scrammyfive
[1] NaN

$scrammyfour
[1] 122.3823

$scrammyseven
[1] 291.9673

$scrammysix
[1] 248.9343

$scrammythree
[1] 98.32728

$scrammytwo
[1] NaN</code></pre>
</div>
</div>
<p>The fitted detection function and esa.plot indicate that a 300 m buffer width is sufficient to encompass all individuals with any non-negligible probability of being captured. The estimated density reaches a plateau before 300m.</p>
</section>
<section id="plotting-alternate-model-fits" class="level2">
<h2 class="anchored" data-anchor-id="plotting-alternate-model-fits">Plotting alternate model fits</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.EX, <span class="at">limits =</span> T, <span class="at">xval =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.HN, <span class="at">limits =</span> T, <span class="at">xval =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Dunnart_Density_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="population-size-estimate" class="level2">
<h2 class="anchored" data-anchor-id="population-size-estimate">Population size estimate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load habitat layer</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>habitat_layer <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/AOI_DISSOLVED.shp"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform so it has the same projection as the trap file</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>habitat_layer <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(habitat_layer, <span class="at">crs =</span> <span class="dv">7855</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Area of the region is about 5,725 ha</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">region.N</span>(fit.EX,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">region =</span> habitat_layer</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$campbellsseven
    estimate SE.estimate      lcl      ucl n
E.N 1998.150    388.1353 1370.292 2913.689 6
R.N 1996.927    385.5527 1372.881 2905.878 6

$campbellssix
    estimate SE.estimate      lcl      ucl n
E.N 1998.150    388.1353 1370.292 2913.689 9
R.N 1999.927    385.5527 1375.881 2908.878 9

$campbellstwo
    estimate SE.estimate      lcl      ucl n
E.N 1998.150    388.1353 1370.292 2913.689 3
R.N 1994.617    385.5527 1370.530 2903.512 3

$scrammyfive
    estimate SE.estimate      lcl      ucl n
E.N 1997.547    388.0183 1369.878 2912.810 4
R.N 1994.213    385.4356 1370.364 2902.898 4

$scrammyfour
    estimate SE.estimate      lcl      ucl n
E.N 1997.547    388.0183 1369.878 2912.810 1
R.N 1993.620    385.4356 1369.626 2902.109 1

$scrammyseven
    estimate SE.estimate      lcl      ucl n
E.N 1997.547    388.0183 1369.878 2912.810 5
R.N 1995.213    385.4356 1371.364 2903.898 5

$scrammysix
    estimate SE.estimate      lcl      ucl  n
E.N 1997.547    388.0183 1369.878 2912.810 19
R.N 2009.213    385.4356 1385.364 2917.898 19

$scrammythree
    estimate SE.estimate      lcl      ucl n
E.N 1997.547    388.0183 1369.878 2912.810 9
R.N 1999.213    385.4356 1375.364 2907.898 9

$scrammytwo
    estimate SE.estimate      lcl      ucl n
E.N 1997.547    388.0183 1369.878 2912.810 2
R.N 1996.776    385.4356 1372.653 2905.091 2</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>